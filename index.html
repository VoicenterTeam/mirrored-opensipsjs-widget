<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenSIPS Widget</title>
</head>
<body>
    <script type="module" src="/src/main.ts"></script>

    <opensips-widget id="openSIPSWidget"></opensips-widget>

    <script>
        const widget = document.getElementById('openSIPSWidget')

        let widgetAPI = null
        const credentials = {
            username: '',
            password: '',
            domain: ''
        }

        async function onWidgetInitialized ({ detail: OpenSIPSExternalWidgetAPI }) {
            const themeSettings = {
                colors: {
                    primary: '#5E95E8',
                    secondary: '#0d8099',
                    'main-text': '#414C59',
                    'secondary-text': '#8292A5',
                    'button-pressed-text': '#FFF',
                    'border-lines': '#DDD',
                    'primary-bg': '#FFF',
                    'secondary-bg': '#F0F2F4',
                    'inactive-bg': '#B9C2CC',
                    'success': '#7CC24F',
                    'danger': '#EC2A2A',
                    'additional-danger-bg': '#F44C4C',
                    'additional-success-bg': '#75B8A0',
                    'additional-bg': '#B0BFC2'
                },
                layoutConfig: {
                    mode: 'fixed',
                    type: 'rounded',
                    position: {
                        top: '50px',
                        anchor: 'top-center',
                    }
                },
                images: {
                    backgroundLogo: undefined
                }
            }
            const callSettings = {
                allowTransfer: true,
                isQuickCall: true,
                quickCallNumber: '665',
                autoAnswer: {
                    allowChange: true,
                    defaultBehavior: false
                },
                outgoingCalls: true,
                callerInfo: {
                    displayName: true,
                    callerId: {
                        display: true,
                        mask: true
                    }
                },
                shrinkOnIdle: false,
                ringingSound: '',
                outgoingCallPlaceHolder: '',
                outgoingInputRegexValidator: [
                  /^\+?\d*$/
                ]
            }
            const config = {
                themeSettings,
                callSettings
            }

            widgetAPI = new OpenSIPSExternalWidgetAPI(config)

            //await widgetAPI.login(credentials)
        }

        async function onLogin () {
            await widgetAPI.login(credentials)
        }


        widget.addEventListener('widget:ready', onWidgetInitialized)
        widget.addEventListener('widget:login', onLogin)
    </script>
</body>
</html>
